{
  "id": "5fb12e9d48afc300228c7069",
  "title": "ABC183",
  "created": 1605447327,
  "updated": 1606011179,
  "lines": [
    {
      "id": "5fb12e9d48afc300228c7069",
      "text": "ABC183",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605447327,
      "updated": 1605447328
    },
    {
      "id": "5fb12f0aaff09e00005baa46",
      "text": "ついに全問正解した！しかもノーミス。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605447434,
      "updated": 1605447525
    },
    {
      "id": "5fb1433faff09e000026fc3b",
      "text": "コンテスト中に全問終わるの初めてだったので、21分くらい残った時間を何に使ったら良いかわからなくて食器と浴槽を洗ってました(苦笑)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452608,
      "updated": 1605452608
    },
    {
      "id": "5fb12ee9aff09e000026fc39",
      "text": "[https://gyazo.com/c3a83f04dc6802c2d35d8b209448675b]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605447402,
      "updated": 1605447419
    },
    {
      "id": "5fb12efbaff09e000026fc3a",
      "text": "Fは正解のつもりでなく「ダメだと思うけど速度だけが問題であって答えはあってるのかを確認しよう」と思って送信したら意外と時間内に収まったのでビックリした。つまり考察は間違っていたが「速度を実際より遅く見積もる」というミスだったのでダメ元送信で通った。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605447419,
      "updated": 1605452636
    },
    {
      "id": "5fb1435baff09e000026fc3d",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452636,
      "updated": 1605452636
    },
    {
      "id": "5fb1435caff09e000026fc3e",
      "text": "A",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452636,
      "updated": 1605452642
    },
    {
      "id": "5fb1436faff09e000026fc47",
      "text": "\tmax(0, x)とか考えた人もいるみたいだけど素朴にやりました 40sec",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452655,
      "updated": 1605452971
    },
    {
      "id": "5fb14362aff09e000026fc40",
      "text": "\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452642,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc41",
      "text": "\t x = int(input())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc42",
      "text": "  if x > 0:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc43",
      "text": "      print(x)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc44",
      "text": "  else:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc45",
      "text": "      print(0)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452652
    },
    {
      "id": "5fb1436caff09e000026fc46",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452652,
      "updated": 1605452653
    },
    {
      "id": "5fb143baaff09e000026fc48",
      "text": "B",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452731,
      "updated": 1605452732
    },
    {
      "id": "5fb143cfaff09e000026fc51",
      "text": "\tビリヤードのボールの半径がゼロだったので驚いた",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452752,
      "updated": 1605453480
    },
    {
      "id": "5fb14693aff09e00005baa4b",
      "text": "\t今回、僕の得意な数学問題が出なかったなーと思ってたけどもこの問題で30分溶かしたり二分探索したりした人もいるみたい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453459,
      "updated": 1605453459
    },
    {
      "id": "5fb14654aff09e00005baa4a",
      "text": "\tdxが負の時のことを少し心配して考えたがケアしなくて大丈夫 5min",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453396,
      "updated": 1605577814
    },
    {
      "id": "5fb144d9aff09e000026fc52",
      "text": "\t公式解説",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453018,
      "updated": 1605453140
    },
    {
      "id": "5fb14553aff09e000026fc54",
      "text": "\t\tSxから Gxへの変化を Sy:Gyに内分する ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453140,
      "updated": 1606010941
    },
    {
      "id": "5fb9c83caff09e00007bb905",
      "text": "\t\t\t[$ \\frac{S_x G_y+G_x  S_y}{S_y+G_y}]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1606010941,
      "updated": 1606010941
    },
    {
      "id": "5fb145bfaff09e00005baa47",
      "text": "\t\t僕の解法",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453251,
      "updated": 1606010938
    },
    {
      "id": "5fb9c83aaff09e00007bb904",
      "text": "\t\t\t[$ \\frac{S_y (G_x - S_x)}{G_y + S_y} + S_x]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1606010938,
      "updated": 1606010938
    },
    {
      "id": "5fb143bcaff09e000026fc4a",
      "text": "\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452733,
      "updated": 1605452743
    },
    {
      "id": "5fb143c7aff09e000026fc4b",
      "text": "  SX, SY, GX, GY = map(int, input().split())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452749
    },
    {
      "id": "5fb143c8aff09e000026fc4c",
      "text": "  dx = GX - SX",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452749
    },
    {
      "id": "5fb143c8aff09e000026fc4d",
      "text": "  dy = GY + SY",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452749
    },
    {
      "id": "5fb143c8aff09e000026fc4e",
      "text": "  ret = SY / dy * dx + SX",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452749
    },
    {
      "id": "5fb143c8aff09e000026fc4f",
      "text": "  print(ret)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452749
    },
    {
      "id": "5fb143c8aff09e000026fc50",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452744,
      "updated": 1605452745
    },
    {
      "id": "5fb14362aff09e000026fc3f",
      "text": "C",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605452642,
      "updated": 1605453270
    },
    {
      "id": "5fb145d6aff09e000026fc61",
      "text": "\t8の階乗は40320です",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453270,
      "updated": 1605453299
    },
    {
      "id": "5fb145f2aff09e00005baa48",
      "text": "\t全探索でOK",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453299,
      "updated": 1605453306
    },
    {
      "id": "5fb145faaff09e00005baa49",
      "text": "\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453307,
      "updated": 1605453314
    },
    {
      "id": "5fb14601aff09e000026fc62",
      "text": "\t def solve(N, K, dist):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453314,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc63",
      "text": "      from itertools import permutations",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc64",
      "text": "      ret = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc65",
      "text": "      for order in permutations(range(1, N)):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc66",
      "text": "          d = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc67",
      "text": "          prev = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc68",
      "text": "          for x in order:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc69",
      "text": "              d += dist[prev][x]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc6a",
      "text": "              prev = x",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc6b",
      "text": "          d += dist[prev][0]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453329
    },
    {
      "id": "5fb1460daff09e000026fc6d",
      "text": "          if d == K:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc6e",
      "text": "              ret += 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc6f",
      "text": "      return ret",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453326
    },
    {
      "id": "5fb1460daff09e000026fc70",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453326,
      "updated": 1605453331
    },
    {
      "id": "5fb1461daff09e000026fc71",
      "text": "D",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453342,
      "updated": 1605453342
    },
    {
      "id": "5fb1461faff09e000026fc73",
      "text": "\t溜めておけないことに注意",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453343,
      "updated": 1605453492
    },
    {
      "id": "5fb146b7aff09e00005baa4c",
      "text": "\t溜めておけないので、各時点での需要量を調べて供給を超えないことが必要",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453496,
      "updated": 1605453548
    },
    {
      "id": "5fb146e1aff09e00005baa4d",
      "text": "\t開始と終了をリストに入れてソートしかけたが開始や終了が同じ点に重なってる時にバグらずにきちんと実装するのは面倒だなと考えて、改めて問題条件をみたら時間軸解像度が10^5程度だったので[いもす法]にしました",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453537,
      "updated": 1605601991
    },
    {
      "id": "5fb1477faff09e00005baa4e",
      "text": "\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453696,
      "updated": 1605453716
    },
    {
      "id": "5fb14794aff09e000026fc74",
      "text": "  N, W = map(int, input().split())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453716,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc75",
      "text": "  diff = [0] * 20_0010",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc76",
      "text": "  for _i in range(N):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc77",
      "text": "      S, T, P = map(int, input().split())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc78",
      "text": "      diff[S] += P",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc79",
      "text": "      diff[T] -= P",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7a",
      "text": "  usage = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7b",
      "text": "  for v in diff:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7c",
      "text": "      usage += v",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7d",
      "text": "      if usage > W:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7e",
      "text": "          print(\"No\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc7f",
      "text": "          return",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc80",
      "text": "  print(\"Yes\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453721
    },
    {
      "id": "5fb14794aff09e000026fc81",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453717,
      "updated": 1605453719
    },
    {
      "id": "5fb147acaff09e000026fc82",
      "text": "E",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453740,
      "updated": 1605453741
    },
    {
      "id": "5fb147adaff09e000026fc84",
      "text": "\t考えたこと",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453741,
      "updated": 1605453766
    },
    {
      "id": "5fb147c6aff09e00005baa4f",
      "text": "\t　普通にDPすると、2000×2000×3×2000で間に合わなさそう",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453766,
      "updated": 1605453799
    },
    {
      "id": "5fb147ecaff09e00005baa50",
      "text": "\t　3方向の範囲和を累積和を使って定数オーダーにすれば2000×2000だから良さそう",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453805,
      "updated": 1605453869
    },
    {
      "id": "5fb1482daff09e00005baa51",
      "text": "\t　まず素直なDPでサンプルケース通ることを確認し、それから累積和に変える [累積和しながらDP]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453869,
      "updated": 1605602012
    },
    {
      "id": "5fb1489baff09e00005baa52",
      "text": "\t　　こんな感じ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453979,
      "updated": 1605453989
    },
    {
      "id": "5fb147acaff09e000026fc83",
      "text": "\t\t\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453741,
      "updated": 1605453934
    },
    {
      "id": "5fb14884aff09e000026fc96",
      "text": "    # hvalue = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453956,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc87",
      "text": "    # p = pos",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc88",
      "text": "    # while True:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc89",
      "text": "    #     p -= 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8a",
      "text": "    #     if data[p] == 0:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8b",
      "text": "    #         break",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8c",
      "text": "    #     hvalue += table[p]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8d",
      "text": "    # debug(divmod(pos, WIDTH), hvalue, msg=\":pos\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8e",
      "text": "    hvalue = h_accum[pos - 1]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc8f",
      "text": "    # debug(divmod(pos, WIDTH), hvalue, msg=\":accum\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605453969
    },
    {
      "id": "5fb1486eaff09e000026fc90",
      "text": "　　horizontal, vertical, diagonalの3方向の累積和を扱う",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605453934,
      "updated": 1605454142
    },
    {
      "id": "5fb1491daff09e00005baa54",
      "text": "　　壁を通れないことは壁のところで累積和をゼロにすれば良い",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454114,
      "updated": 1605454114
    },
    {
      "id": "5fb14983aff09e00005baa55",
      "text": "　　地図は[地図を1次元配列に入れる]してる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454214,
      "updated": 1605454364
    },
    {
      "id": "5fb148f3aff09e00005baa53",
      "text": "\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454068,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc98",
      "text": "\t def solve(H, W, data):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc99",
      "text": "      MOD = 1_000_000_007",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc9a",
      "text": "      N = len(data)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb14957aff09e000026fcbb",
      "text": "      table = [0] * N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454167,
      "updated": 1605454167
    },
    {
      "id": "5fb1494daff09e000026fc9b",
      "text": "      h_accum = [0] * N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc9c",
      "text": "      v_accum = [0] * N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc9d",
      "text": "      d_accum = [0] * N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fc9e",
      "text": "  ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454167
    },
    {
      "id": "5fb1494daff09e000026fca0",
      "text": "      table[WIDTH + 1] = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca1",
      "text": "      h_accum[WIDTH + 1] = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca2",
      "text": "      v_accum[WIDTH + 1] = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca3",
      "text": "      d_accum[WIDTH + 1] = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca4",
      "text": "      for pos in allPosition():",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca5",
      "text": "          if pos == WIDTH + 1:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca6",
      "text": "              continue",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca7",
      "text": "          if data[pos] == 0:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca8",
      "text": "              table[pos] = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fca9",
      "text": "              h_accum[pos] = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcaa",
      "text": "              v_accum[pos] = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcab",
      "text": "              d_accum[pos] = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcac",
      "text": "              continue",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcad",
      "text": "  ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcae",
      "text": "          h_value = h_accum[pos - 1]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcaf",
      "text": "          v_value = v_accum[pos - WIDTH]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb0",
      "text": "          d_value = d_accum[pos - WIDTH - 1]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb1",
      "text": "  ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb2",
      "text": "          ret = h_value + v_value + d_value",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb3",
      "text": "          ret %= MOD",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb4",
      "text": "          table[pos] = ret",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb5",
      "text": "          h_accum[pos] = (h_accum[pos - 1] + ret) % MOD",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb6",
      "text": "          v_accum[pos] = (v_accum[pos - WIDTH] + ret) % MOD",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb7",
      "text": "          d_accum[pos] = (d_accum[pos - WIDTH - 1] + ret) % MOD",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb8",
      "text": "  ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcb9",
      "text": "      return ret",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454157
    },
    {
      "id": "5fb1494daff09e000026fcba",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454157,
      "updated": 1605454159
    },
    {
      "id": "5fb1494baff09e000026fc97",
      "text": "F",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454156,
      "updated": 1605454372
    },
    {
      "id": "5fb14a24aff09e000026fcbd",
      "text": "\t考えたこと",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454372,
      "updated": 1605454387
    },
    {
      "id": "5fb14a3aaff09e00005baa57",
      "text": "\t　クラスの種類は20万ありえる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454396,
      "updated": 1605454419
    },
    {
      "id": "5fb14a48aff09e00005baa58",
      "text": "\t　UnionFindでできなさそう？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454419,
      "updated": 1605454443
    },
    {
      "id": "5fb14a69aff09e00005baa5a",
      "text": "\t　　対数オーダーでできないか？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454447,
      "updated": 1605454458
    },
    {
      "id": "5fb14a77aff09e00005baa5b",
      "text": "\t　UnionFindでやる場合、代表元にクラスごとの個数を持たせる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454458,
      "updated": 1605454503
    },
    {
      "id": "5fb14aa3aff09e00005baa5c",
      "text": "\t　　「クラスxが何人」という値を素朴に配列で持つとO(N)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454503,
      "updated": 1605454579
    },
    {
      "id": "5fb14ad4aff09e00005baa5d",
      "text": "\t　　読み出しは定数オーダー",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454584,
      "updated": 1605454584
    },
    {
      "id": "5fb14ae5aff09e00005baa5e",
      "text": "\t　　　これを対数オーダーまで落として良いので、代わりにマージを高速にしたい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454584,
      "updated": 1605454593
    },
    {
      "id": "5fb14b1daff09e00005baa5f",
      "text": "\t　　読み出しを対数オーダーにする→二分探索",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454624,
      "updated": 1605454645
    },
    {
      "id": "5fb14b2faff09e00005baa60",
      "text": "\t　　　ソート済み配列として持ったらどうなる？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454645,
      "updated": 1605454659
    },
    {
      "id": "5fb14b3daff09e00005baa61",
      "text": "\t　　　マージは内容物の量の線形オーダー",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454659,
      "updated": 1605454678
    },
    {
      "id": "5fb14b4eaff09e00005baa62",
      "text": "\t　　内容物のオーダーでいいならハッシュテーブルで良いのでは",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454678,
      "updated": 1605454860
    },
    {
      "id": "5fb14c04aff09e00005baa63",
      "text": "\t　　　キーがないことがあるのでdefaultdict、いや、個数カウントだからCounterか",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454860,
      "updated": 1605455008
    },
    {
      "id": "5fb14ff6aff09e00005baa65",
      "text": "\t　　一旦それで送信してみて他のバグがないか確認してみよう→意外とあっさりAC",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605455871,
      "updated": 1605455921
    },
    {
      "id": "5fb15033aff09e00005baa66",
      "text": "\t実装",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605455924,
      "updated": 1605455927
    },
    {
      "id": "5fb14c99aff09e00005baa64",
      "text": "\t　UnionFindライブラリに手を入れてマージ時にCounterを更新する",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605455008,
      "updated": 1605456810
    },
    {
      "id": "5fb14a23aff09e000026fcbc",
      "text": "  \tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454372,
      "updated": 1605455871
    },
    {
      "id": "5fb14c33aff09e000026fcbf",
      "text": "  \t def unite(x, y):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454899,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc0",
      "text": "        x = find_root(x)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc1",
      "text": "        y = find_root(y)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc2",
      "text": "        if x == y:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc3",
      "text": "            return  # already united",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc4",
      "text": "        if rank[x] < rank[y]:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc5",
      "text": "            parent[x] = y",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc6",
      "text": "            cls[y].update(cls[x])  # ***",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc7",
      "text": "        else:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc8",
      "text": "            parent[y] = x",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcc9",
      "text": "            if rank[x] == rank[y]:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fcca",
      "text": "                rank[x] += 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb14c34aff09e000026fccb",
      "text": "            cls[x].update(cls[y])  # ***",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455871
    },
    {
      "id": "5fb1503caff09e00005baa67",
      "text": "  本体",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605455934,
      "updated": 1605455943
    },
    {
      "id": "5fb14c34aff09e000026fccc",
      "text": "  \tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454900,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fccd",
      "text": "  \t def main():",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454934,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcce",
      "text": "        global cls",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fccf",
      "text": "        from collections import Counter",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd0",
      "text": "        N, Q = map(int, input().split())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd2",
      "text": "        init_unionfind(N)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd3",
      "text": "        CS = list(map(int, input().split()))",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd4",
      "text": "        cls = [Counter([CS[i] - 1]) for i in range(N)]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd5",
      "text": "        for _q in range(Q):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd7",
      "text": "            typ, a, b = map(int, input().split())",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd8",
      "text": "            if typ == 1:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcd9",
      "text": "                unite(a - 1, b - 1)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcda",
      "text": "            else:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcdb",
      "text": "                root = find_root(a - 1)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcdc",
      "text": "                print(cls[root].get(b - 1, 0))",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605455943
    },
    {
      "id": "5fb14c56aff09e000026fcde",
      "text": "　公式解説",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605454935,
      "updated": 1605456010
    },
    {
      "id": "5fb1508aaff09e00005baa69",
      "text": "　　小さい方を大きい方にマージすれば、マージごとにサイズが2倍以上になるので最悪でもlogN回しかマージされないのでNlogN未満で収まる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605456011,
      "updated": 1605577989
    },
    {
      "id": "5fb38735aff09e000026fcdf",
      "text": "　　\t[小さい方から大きい方へ移す]ことで最悪計算量が改善される",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605601078,
      "updated": 1605601087
    },
    {
      "id": "5fb150cbaff09e00005baa6a",
      "text": "　　この見積もりはできてなかった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605456075,
      "updated": 1605456094
    },
    {
      "id": "5fb15086aff09e00005baa68",
      "text": "　　　最悪ケースでダメなことには気付いていたが解決策が思いついてなかった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1605456007,
      "updated": 1606011108
    },
    {
      "id": "5fb9c8e4aff09e0000795cff",
      "text": "　　　しかしUnionFindの実装で木の高さを圧縮するために「ランクの高い方に低い方をマージ」してることによって類似の効果が起きて間に合った",
      "userId": "582e63d27c56960011aff09e",
      "created": 1606011108,
      "updated": 1606011179
    },
    {
      "id": "5fb9c8d2aff09e0000795cfe",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1606011090,
      "updated": 1606011090
    }
  ]
}