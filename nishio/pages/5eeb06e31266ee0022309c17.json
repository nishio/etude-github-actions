{
  "id": "5eeb06e31266ee0022309c17",
  "title": "剰余群での除算",
  "created": 1592461035,
  "updated": 1608391418,
  "lines": [
    {
      "id": "5eeb06e31266ee0022309c17",
      "text": "剰余群での除算",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461035,
      "updated": 1592461041
    },
    {
      "id": "5eeb0777aff09e0000faa6ec",
      "text": "大きな素数Nと適当な数K, Rが与えられた時に、KxのNでのあまりがRになるようなxを求めたい。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461176,
      "updated": 1592461356
    },
    {
      "id": "5eeb09bbaff09e000077c901",
      "text": "\t`Kx mod N = R`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461756,
      "updated": 1592461757
    },
    {
      "id": "5eeb0a11aff09e0000faa6f6",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461841,
      "updated": 1592461842
    },
    {
      "id": "5eeb07d2aff09e0000faa6ed",
      "text": "これは[剰余群]の中でKをRで割ることに相当する。[既約剰余類群]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461266,
      "updated": 1592464493
    },
    {
      "id": "5eeb0a13aff09e0000faa6f7",
      "text": "　Kの[mod Pでの逆元]を求めてRに掛けたという解釈もできる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461844,
      "updated": 1602324221
    },
    {
      "id": "5f7f2686aff09e00001012fa",
      "text": "　単純に割り算をしてはいけない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602168454,
      "updated": 1602168516
    },
    {
      "id": "5f7f26c4aff09e00001012fb",
      "text": "　　例 2x mod 7=1の場合の答えは4",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602168516,
      "updated": 1602168572
    },
    {
      "id": "5f7f26fdaff09e00001012fd",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602168574,
      "updated": 1602168574
    },
    {
      "id": "5eeb082eaff09e0000faa6ef",
      "text": "まずR=1について解く。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461358,
      "updated": 1592461490
    },
    {
      "id": "5eeb08b1aff09e0000faa6f1",
      "text": "　NとKに[ユークリッドの互除法]を使う",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461490,
      "updated": 1592461609
    },
    {
      "id": "5eeb08b4aff09e0000faa6f2",
      "text": "　ただし最大公約数を求めることが目的ではない。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461492,
      "updated": 1592461492
    },
    {
      "id": "5eeb08aeaff09e0000faa6f0",
      "text": "　　Nが素数だから最大公約数が1であることは既知",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461487,
      "updated": 1592461616
    },
    {
      "id": "5eeb08bbaff09e0000faa6f3",
      "text": "　1をNとKの線形結合で表現することが目的",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461499,
      "updated": 1592461529
    },
    {
      "id": "5eeb0952aff09e0000faa6f5",
      "text": "　　`aN + bK == 1`の形",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461650,
      "updated": 1592464512
    },
    {
      "id": "5eeb0938aff09e0000faa6f4",
      "text": "　　aNはmod Nで消えるので[$ bK  \\equiv 1 \\pmod{N}]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461624,
      "updated": 1602172608
    },
    {
      "id": "5fde1ad0aff09e00003fbabc",
      "text": "　　\tつまりbはmod NでのKの逆元",
      "userId": "582e63d27c56960011aff09e",
      "created": 1608391377,
      "updated": 1608391418
    },
    {
      "id": "5eeb07e6aff09e0000faa6ee",
      "text": "　　[拡張ユークリッド互除法]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461287,
      "updated": 1602140459
    },
    {
      "id": "5f7eb917aff09e0000f27d72",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602140440,
      "updated": 1602140440
    },
    {
      "id": "5eeb0a21aff09e0000faa6f9",
      "text": "得られた式の両辺をR倍すれば求める除算結果が得られる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461857,
      "updated": 1602173301
    },
    {
      "id": "5eeb0a1faff09e0000faa6f8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461855,
      "updated": 1592461855
    },
    {
      "id": "5f7f3947aff09e0000245e95",
      "text": "code:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173256,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e96",
      "text": " def mod_inverse_ee(a, m):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e97",
      "text": "     \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e98",
      "text": "     Solve ax mod m = 1 with extended euclidean.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e99",
      "text": "     x = a^-1.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e9a",
      "text": "     \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e9b",
      "text": "     x, y, g = extended_euclidean(a, m)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e9c",
      "text": "     assert g == 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e9d",
      "text": "     return x % m",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245e9e",
      "text": "  ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173265
    },
    {
      "id": "5f7f3949aff09e0000245ea2",
      "text": " def extended_euclidean(a, b, test=False):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea3",
      "text": "     \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea4",
      "text": "     Extended Euclidean algorithm",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea5",
      "text": "     Given a, b, solve:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea6",
      "text": "     ax + by = gcd(a, b)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea7",
      "text": "     Returns x, y, gcd(a, b)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea8",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ea9",
      "text": "     Other form, for a prime b:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eaa",
      "text": "     ax mod b = gcd(a, b) = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eab",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eac",
      "text": "     >>> extended_euclidean(3, 5, test=True)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ead",
      "text": "     3 * 2 + 5 * -1 = 1 True",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eae",
      "text": "     >>> extended_euclidean(240, 46, test=True)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eaf",
      "text": "     240 * -9 + 46 * 47 = 2 True",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb0",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb1",
      "text": "     Derived from https://atcoder.jp/contests/acl1/submissions/16914912",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb2",
      "text": "     \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb3",
      "text": "     init_a = a",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb4",
      "text": "     init_b = b",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb5",
      "text": "     s, u, v, w = 1, 0, 0, 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb6",
      "text": "     while b:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb7",
      "text": "         q, r = divmod(a, b)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb8",
      "text": "         a, b = b, r",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eb9",
      "text": "         s, u, v, w = v, w, s - q * v, u - q * w",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245eba",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ebb",
      "text": "     if test:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ebc",
      "text": "         print(f\"{init_a} * {s} + {init_b} * {u} = {a}\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ebd",
      "text": "               init_a * s + init_b * u == a)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ebe",
      "text": "     else:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ebf",
      "text": "         return s, u, a",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173257
    },
    {
      "id": "5f7f3949aff09e0000245ec0",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602173257,
      "updated": 1602173259
    },
    {
      "id": "5f7f3514aff09e0000245e91",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602172181,
      "updated": 1602172181
    },
    {
      "id": "5f7f3522aff09e0000245e93",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602172194,
      "updated": 1602172194
    },
    {
      "id": "5f7f3522aff09e0000245e94",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602172194,
      "updated": 1602172194
    },
    {
      "id": "5f7f3515aff09e0000245e92",
      "text": "--- old version 2020/06/18",
      "userId": "582e63d27c56960011aff09e",
      "created": 1602172181,
      "updated": 1602172193
    },
    {
      "id": "5eeb0712aff09e000077c8e5",
      "text": "code:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461075,
      "updated": 1592461104
    },
    {
      "id": "5eeb072faff09e000077c8e6",
      "text": " \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461104,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8e7",
      "text": " Given K, N, R, find x s.t. Kx mod N = R",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8e8",
      "text": " \"\"\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8e9",
      "text": " R = 1234567",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ea",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8eb",
      "text": " # Solve Kx + Ny = 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ec",
      "text": " N = 9999991",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ed",
      "text": " K = 2236206",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ee",
      "text": " a = N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ef",
      "text": " b = K",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f0",
      "text": " vec = [(1, 0), (0, 1)]  # b = 0 N + 1 K",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f1",
      "text": " while True:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f2",
      "text": "     q = a // b",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f3",
      "text": "     r = a % b",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f4",
      "text": "     # print(q, r)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f5",
      "text": "     (aa, ab), (ba, bb) = vec",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f6",
      "text": "     vec = [(ba, bb), (aa - q * ba, ab - q * bb)]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f7",
      "text": "     # print(vec)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f8",
      "text": "     if r == 1:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8f9",
      "text": "         break",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8fa",
      "text": "     a, b = b, r",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8fb",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8fc",
      "text": " _, (ba, bb) = vec",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8fd",
      "text": " print(f\"{N} * {ba} + {K} * {bb} == 1\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb0a4aaff09e000077c903",
      "text": "\t# => 9999991 * 3109 + 2236206 * -13903 == 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461899,
      "updated": 1592461916
    },
    {
      "id": "5eeb073caff09e000077c8fe",
      "text": " x = bb * R % N",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb073caff09e000077c8ff",
      "text": " print(f\"{K} * {x} mod {N} = {R}\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461117
    },
    {
      "id": "5eeb0a4eaff09e000077c904",
      "text": " # => 2236206 * 5799546 mod 9999991 = 1234567",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461903,
      "updated": 1592461913
    },
    {
      "id": "5eeb073caff09e000077c900",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461117,
      "updated": 1592461118
    },
    {
      "id": "5eeb06f1aff09e0000faa6ea",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461041,
      "updated": 1592461066
    },
    {
      "id": "5eeb06fcaff09e0000faa6eb",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1592461052,
      "updated": 1592461052
    }
  ]
}