{
  "id": "5e13255755c35200178e236c",
  "title": "TypeScriptの型の練習",
  "created": 1578313055,
  "updated": 1580886173,
  "lines": [
    {
      "id": "5e13255755c35200178e236c",
      "text": "TypeScriptの型の練習",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313055,
      "updated": 1578313150
    },
    {
      "id": "5e132566aff09e000008fef2",
      "text": "[TypeScriptの型]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313063,
      "updated": 1580886173
    },
    {
      "id": "5e132566aff09e000008fef3",
      "text": "code:typescript",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313063,
      "updated": 1578313069
    },
    {
      "id": "5e13256daff09e000008fef5",
      "text": " const obj = {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fef6",
      "text": "   s: \"foo\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fef7",
      "text": "   f: () => \"bar\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fef8",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fef9",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fefa",
      "text": " const get1 = (key: keyof typeof obj) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fefb",
      "text": "   return obj[key]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fefc",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fefd",
      "text": " // const get1: (key: \"s\" | \"f\") => string | (() => string)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e13256eaff09e000008fefe",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313070
    },
    {
      "id": "5e1335e1aff09e00002c949d",
      "text": " const get2 = (key: keyof typeof obj) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317575
    },
    {
      "id": "5e1335e1aff09e00002c94a0",
      "text": "   const value = obj[key]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317288
    },
    {
      "id": "5e1335e1aff09e00002c94a1",
      "text": "   if (typeof value === \"string\") {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317288
    },
    {
      "id": "5e1335e1aff09e00002c94a2",
      "text": "     return value",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317580
    },
    {
      "id": "5e1335e1aff09e00002c94a3",
      "text": "   } else {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317288
    },
    {
      "id": "5e1335e1aff09e00002c94a4",
      "text": "     return () => value()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317584
    },
    {
      "id": "5e1335e1aff09e00002c94a5",
      "text": "   }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317288
    },
    {
      "id": "5e1335e1aff09e00002c94a6",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317282,
      "updated": 1578317288
    },
    {
      "id": "5e13256eaff09e000008feff",
      "text": " // const get2: (key: \"s\" | \"f\") => string | (() => string)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578317282
    },
    {
      "id": "5e13256eaff09e000008ff08",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313070,
      "updated": 1578313071
    },
    {
      "id": "5e132592aff09e000008ff09",
      "text": "元ネタ https://twitter.com/teramotodaiki/status/1214149145935532033",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313106,
      "updated": 1578313125
    },
    {
      "id": "5e132d67aff09e000008ff0b",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315111,
      "updated": 1578315111
    },
    {
      "id": "5e132d67aff09e000008ff0c",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315111,
      "updated": 1578315115
    },
    {
      "id": "5e132d6baff09e000008ff0e",
      "text": " function get4<Key extends keyof typeof obj>(key: Key): typeof obj[Key] {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315115,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff0f",
      "text": "   return obj[key];",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff10",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff11",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff12",
      "text": " // ERROR",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff13",
      "text": " // function get5<Key extends keyof typeof obj>(key: Key): typeof obj[Key] extends string ? string : () => string {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff14",
      "text": " //   return obj[key];",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132d6baff09e000008ff15",
      "text": " // }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315116
    },
    {
      "id": "5e132e56aff09e000008ff26",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315350,
      "updated": 1578315350
    },
    {
      "id": "5e132e56aff09e000008ff27",
      "text": " function get6<Key extends keyof typeof obj>(key: Key): any {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315350,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff28",
      "text": "   const value = obj[key]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff29",
      "text": "   if (typeof value === \"string\") {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2a",
      "text": "     return value",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2b",
      "text": "   } else {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2c",
      "text": "     return () => value() // ERROR",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2d",
      "text": "     // This expression is not callable.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2e",
      "text": "     // Not all constituents of type 'string | (() => string)' are callable.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff2f",
      "text": "     //   Type 'string' has no call signatures.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff30",
      "text": "   }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132e57aff09e000008ff31",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315351,
      "updated": 1578315351
    },
    {
      "id": "5e132d6baff09e000008ff16",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315116,
      "updated": 1578315117
    },
    {
      "id": "5e1332bbaff09e000008ff3b",
      "text": "`key`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578316476,
      "updated": 1578316483
    },
    {
      "id": "5e132d68aff09e000008ff0d",
      "text": "\tget2",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315112,
      "updated": 1578316459
    },
    {
      "id": "5e1332abaff09e000008ff39",
      "text": "\t\t`keyof typeof obj` === `\"s\" | \"f\"`なので",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578316460,
      "updated": 1578316466
    },
    {
      "id": "5e132dcdaff09e000008ff18",
      "text": "\t\t`(parameter) key: \"s\" | \"f\"`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315214,
      "updated": 1578316443
    },
    {
      "id": "5e132dddaff09e000008ff1c",
      "text": "\tget4",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315229,
      "updated": 1578316444
    },
    {
      "id": "5e132da8aff09e000008ff17",
      "text": "\t\t`(parameter) key: Key extends \"s\" | \"f\"`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315176,
      "updated": 1578316446
    },
    {
      "id": "5e132dd2aff09e000008ff19",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315219,
      "updated": 1578315219
    },
    {
      "id": "5e132decaff09e000008ff1e",
      "text": "`const value = obj[key]`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315244,
      "updated": 1578315487
    },
    {
      "id": "5e132dfdaff09e000008ff1f",
      "text": "\tget2",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315261,
      "updated": 1578316448
    },
    {
      "id": "5e132e09aff09e000008ff20",
      "text": "\t\t`const value: string | (() => string)`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315274,
      "updated": 1578316449
    },
    {
      "id": "5e132dd2aff09e000008ff1a",
      "text": "\tget6",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315219,
      "updated": 1578316450
    },
    {
      "id": "5e132e1eaff09e000008ff21",
      "text": "\t\tcode:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315294,
      "updated": 1578316453
    },
    {
      "id": "5e132e21aff09e000008ff22",
      "text": "   const value: {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315297,
      "updated": 1578316489
    },
    {
      "id": "5e132e21aff09e000008ff23",
      "text": "       s: string;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315298,
      "updated": 1578316489
    },
    {
      "id": "5e132e21aff09e000008ff24",
      "text": "       f: () => string;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315298,
      "updated": 1578316489
    },
    {
      "id": "5e132e21aff09e000008ff25",
      "text": "   }[Key]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315298,
      "updated": 1578316489
    },
    {
      "id": "5e132dd2aff09e000008ff1b",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315219,
      "updated": 1578315219
    },
    {
      "id": "5e132f26aff09e000008ff32",
      "text": "要するに元ネタのコードでは余計なextendsのせいでkeyの型が`\"s\" | \"f\"`だとわからなくなっており、",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315623,
      "updated": 1578317331
    },
    {
      "id": "5e132ff7aff09e000008ff34",
      "text": "その結果`obj[key]`も`string | (() => string)`だとわからなくなっている",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315768,
      "updated": 1578315847
    },
    {
      "id": "5e133047aff09e000008ff35",
      "text": "`string | (() => string)`ならUnion Typeなので[Type Guards https://www.typescriptlang.org/docs/handbook/advanced-types.html#type-guards-and-differentiating-types]が使えるがget6の方は複雑な型なのでそれができない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578315847,
      "updated": 1578316095
    },
    {
      "id": "5e13313eaff09e000008ff36",
      "text": "(可能だが現時点のTSがサポートしてない)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578316095,
      "updated": 1578316291
    },
    {
      "id": "5e133205aff09e000008ff37",
      "text": "なのでelse節のvalueが`() => string`であることがわからず`Type 'string' has no call signatures`になる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578316294,
      "updated": 1578316430
    },
    {
      "id": "5e133206aff09e000008ff38",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578316294,
      "updated": 1578316294
    },
    {
      "id": "5e1337b8aff09e00002c94a7",
      "text": "---",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317752,
      "updated": 1578317754
    },
    {
      "id": "5e1337baaff09e00002c94a8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317754,
      "updated": 1578317754
    },
    {
      "id": "5e1337baaff09e00002c94a9",
      "text": "`const x = get2(\"f\")  // const x: string | (() => string)`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317754,
      "updated": 1578317778
    },
    {
      "id": "5e1337d4aff09e00002c94aa",
      "text": "うーん、そりゃそうか、関数が呼ばれる前にobjが書き換わる可能性があるからな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317780,
      "updated": 1578323120
    },
    {
      "id": "5e134cafaff09e00002c94bc",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578323120,
      "updated": 1578323120
    },
    {
      "id": "5e1337d4aff09e00002c94ab",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578317780,
      "updated": 1578321327
    },
    {
      "id": "5e1345afaff09e00002c94ac",
      "text": " const x2 = get7(\"s\")  // const x2: string",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321327,
      "updated": 1578321328
    },
    {
      "id": "5e1345afaff09e00002c94ad",
      "text": " const x3 = get7(\"f\")  // const x3: () => string",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321328,
      "updated": 1578321328
    },
    {
      "id": "5e1345afaff09e00002c94ae",
      "text": "こういう挙動が欲しい場合、",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321328,
      "updated": 1578323176
    },
    {
      "id": "5e134ce8aff09e00002c94bd",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578323176,
      "updated": 1578323176
    },
    {
      "id": "5e1345b0aff09e00002c94af",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321329,
      "updated": 1578321331
    },
    {
      "id": "5e1345b2aff09e00002c94b0",
      "text": " function get7(key: \"s\"): string;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321331,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b1",
      "text": " function get7(key: \"f\"): (() => string);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b2",
      "text": " function get7(key: \"s\" | \"f\"): (string | (() => string)) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b3",
      "text": "   const value = obj[key]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b4",
      "text": "   if (typeof value === \"string\") {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b5",
      "text": "     return value",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b6",
      "text": "   } else if (typeof value === \"function\") {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b7",
      "text": "     return () => value()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b8",
      "text": "   }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94b9",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578321336
    },
    {
      "id": "5e1345b8aff09e00002c94ba",
      "text": "となるか",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321336,
      "updated": 1578323206
    },
    {
      "id": "5e1345baaff09e00002c94bb",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578321338,
      "updated": 1578321338
    },
    {
      "id": "5e132568aff09e000008fef4",
      "text": "[TypeScript]の[型]の練習",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313064,
      "updated": 1578313161
    },
    {
      "id": "5e1325c3aff09e000008ff0a",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1578313155,
      "updated": 1578313155
    }
  ]
}