{
  "id": "6090ebffa287e60022919f86",
  "title": "Hatena2009-05-05",
  "created": 1241449200,
  "updated": 1241449200,
  "lines": [
    {
      "id": "6090ec23aff09e00003d0fd7",
      "text": "Hatena2009-05-05",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fd8",
      "text": "code:hatena",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fd9",
      "text": " <body>",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fda",
      "text": " *1241502724*[Python]weakref",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fdb",
      "text": " 知識としては知っていたが始めてweakrefが必要だと感じるシチュエーションにぶつかった。まずは短いコードで挙動を確認してみる。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fdc",
      "text": " >|python|",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fdd",
      "text": " from weakref import WeakValueDictionary",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fde",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fdf",
      "text": " class Foo(list):",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe0",
      "text": "     pass",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe1",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe2",
      "text": " def make():",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe3",
      "text": "     x = Foo([0])",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe4",
      "text": "     y = Foo([1, x])",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe5",
      "text": "     z = Foo([2, y])",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe6",
      "text": "     return WeakValueDictionary(x=x, y=y, z=z), z",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe7",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe8",
      "text": " d, cur = make()",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fe9",
      "text": " print cur",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fea",
      "text": " print d.items()",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0feb",
      "text": " cur = cur[1]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fec",
      "text": " print cur",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fed",
      "text": " print d.items()",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fee",
      "text": " ||<",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fef",
      "text": " 出力は下記",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff0",
      "text": " >||",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff1",
      "text": " [2, [1, [0]]]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff2",
      "text": " [('y', [1, [0]]), ('x', [0]), ('z', [2, [1, [0]]])]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff3",
      "text": " [1, [0]]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff4",
      "text": " [('y', [1, [0]]), ('x', [0])]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff5",
      "text": " ||<",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff6",
      "text": " zへの参照がなくなるとdの中身からも消えている。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff7",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff8",
      "text": " ちなみにlistやintを直接いれようとすると「TypeError: cannot create weak reference to 'list' object」というエラーが出る。あと対話的インタプリタで試していて消えると思ったタイミングで消えなくて戸惑った。暗黙の「_」があるので、例えば代入は式ではないので更新されなくて_が掴んだままになるし、d.items()するとそれが_に入るのでそこからの参照が残る、という罠。「消えないなおかしいなー」と思ってglobals()してみて、もう一度確認すると今度は消えているw",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ff9",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ffa",
      "text": " *1241515605*家事日記",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ffb",
      "text": " 鍋の用意をしていたら腰が痛くなってきた。昨日無理をしすぎたか。明日自転車で御徒町に行くつもりなんだが…。ネギを鍋に入れようとして腰が痛くなるとかどうなってるんだこの腰は。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ffc",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ffd",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0ffe",
      "text": " 鍋に野菜を入れてから鍋の電源ケーブルが見つからないことに気づいて必死で探しまわる。結局<a href='http://d.hatena.ne.jp/nishiohirokazu/20090331'>ビニールテープでマーキング</a>してあったことがよく働いて、PCの電源ケーブルにまぎれていたものを発見。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d0fff",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1000",
      "text": " *1241528522*[SpaMon]カード Ver. 1.4",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1001",
      "text": " <img src=\"http://gyazo.com/fbd63ec4ff017ea3d57c3696d63c048e.png\">",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1002",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1003",
      "text": " Ver 1.4は今つけた。大体4回目くらいだろう(適当) id:TOKOROTEN と遊んだときにJumpの弱化をしたし、id:waruhuzaketaichi と遊んだときに色々書き換えたし、でもってこの前書いていた<a href='http://d.hatena.ne.jp/nishiohirokazu/20090419/1240121206'>ルールの修正</a>、<a href='http://d.hatena.ne.jp/nishiohirokazu/20090427/1240828251'>カード</a>あたりの修正も入れた。もともと18枚分のスペースがあったのでHeal, ChangeBits(元Charm)、SwitchBits(Zapを削除してかわりに追加)の3枚は「****」の追加カードとして一応入れておいた。普通のプレイでは「***」までを使う。横幅を普通のカードサイズのデファクトスタンダードにあうように縮めた関係で上下にまだまだ余裕がある。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1004",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1005",
      "text": " 主な変更点",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1006",
      "text": " - MakeBitとMoveBitがぱっとみ紛らわしいのでAddBitにした",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1007",
      "text": " - RemoveBit, RemoveCard, Surgeのアイコンを変更",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1008",
      "text": " - Zapを完全に削除して代わりにSwitchBitsを入れた。SwapBitsでもいいかも。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1009",
      "text": " - Healが激しく強化されている(初期状態で+6)が、文面を工夫してIncでもDecでも無効化できるようにした。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100a",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100b",
      "text": " Ver 1.5に向けて修正中",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100c",
      "text": " <img src=\"http://gyazo.com/4eb300c353e93eece537351d4e20156c.png\">",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100d",
      "text": " だいぶInkscapeにも慣れたのでJumpをよりわかりやすい絵に。あと1.4は1.2を作るときくらいにデファクトスタンダードのカードサイズに合わせるために単純に縮小して作ったためメンテナビリティの悪い絵になっている。そこらへんをリファクタリング中。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100e",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d100f",
      "text": " <img src=\"http://gyazo.com/5276eae90faf713e13406ac47459e14e.png\">",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1010",
      "text": " Floatのデザイン、before after。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1011",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1012",
      "text": " <img src=\"http://gyazo.com/9101c3798ce9bed1515ad288d21b36be.png\">",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1013",
      "text": " 1.5ができた！",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1014",
      "text": " ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1015",
      "text": " *1241535666*[SpaMon]チップ",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1016",
      "text": " インクリメントとデクリメントにビットと同じチップを使うのはややこしいので作った。ちょっと曲がってたり、縦長だったり横長だったりするけど気にしない。",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1017",
      "text": " f:id:nishiohirokazu:20090506000105j:image",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1018",
      "text": " </body>",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d1019",
      "text": "",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec23aff09e00003d101a",
      "text": "[はてなダイアリー 2009-05-05 https://nishiohirokazu.hatenadiary.org/archive/2009/05/05]",
      "created": 1241449200,
      "updated": 1241449200,
      "userId": "582e63d27c56960011aff09e"
    }
  ]
}