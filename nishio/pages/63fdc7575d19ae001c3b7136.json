{
  "id": "63fdc7575d19ae001c3b7136",
  "title": "GPT3では情報密度が逆転する",
  "created": 1677576025,
  "updated": 1678882932,
  "lines": [
    {
      "id": "63fdc7575d19ae001c3b7136",
      "text": "GPT3では情報密度が逆転する",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576025,
      "updated": 1677576440
    },
    {
      "id": "63fdc758aff09e0000d33b23",
      "text": "[https://gyazo.com/14e4f77793d723af030402d9042df1bf]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576027,
      "updated": 1677576027
    },
    {
      "id": "63fdc758aff09e0000d33b25",
      "text": "[https://gyazo.com/10c1b8c1b9b9b1817d78f1133a748f82][https://gyazo.com/9f52e93ff88b586b14311c82d230a8b8]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576027,
      "updated": 1677576041
    },
    {
      "id": "63fdc766aff09e0000d33b26",
      "text": "[https://gyazo.com/f0a0af30d47e17bf5cebf9d79774f2b6][https://gyazo.com/b5be2d6f88a06f83777451a77264327b]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576041,
      "updated": 1677576041
    },
    {
      "id": "63fdc758aff09e0000d33b24",
      "text": "[https://platform.openai.com/tokenizer OpenAI API: Tokenizer]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576027,
      "updated": 1677576067
    },
    {
      "id": "63fdc77baff09e0000d33b28",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576061,
      "updated": 1677576061
    },
    {
      "id": "63fdc778aff09e0000d33b27",
      "text": "[GPT3]の[トークナイザー]はしばしば漢字一文字を複数のトークンに刻む。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576058,
      "updated": 1677576417
    },
    {
      "id": "63fdc8bdaff09e00007c0d2c",
      "text": "　これは日本人にとっては好ましくない状況",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576382,
      "updated": 1677576426
    },
    {
      "id": "63fdc7caaff09e0000d33b2a",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576341
    },
    {
      "id": "63fdc7caaff09e0000d33b2b",
      "text": "今まで漢字を使う中国人や日本人はアルファベットを使う人たちに比べてインプットする情報の密度が高かった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576865
    },
    {
      "id": "63fdc7caaff09e0000d33b2c",
      "text": "　同じ内容を日本語で書くのと英語で書くのでは英語の方が約2倍面積を取っていた",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576375
    },
    {
      "id": "63fdc7caaff09e0000d33b2d",
      "text": "　人間の物理的視野の広さは人種によって大差ない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576868
    },
    {
      "id": "63fdcaa4aff09e00007c0d30",
      "text": "　なので、日本人は欧米人に比べて一度に目からインプットできる情報量が2倍大きいというアドバンテージがあった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576868,
      "updated": 1677576869
    },
    {
      "id": "63fdc92baff09e00007c0d2e",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576492,
      "updated": 1677576492
    },
    {
      "id": "63fdc7caaff09e0000d33b2e",
      "text": "しかし、GPT3の視点で見ると、同じ内容を日本語と英語で与えた場合には日本語の方が英語よりおよそ2〜3倍の数のトークンになる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576543
    },
    {
      "id": "63fdc7caaff09e0000d33b2f",
      "text": " GPT3が一度にインプットできるトークンは4000程度",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576565
    },
    {
      "id": "63fdc7caaff09e0000d33b30",
      "text": " 　これが人間の物理的視野のようなもの",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576591
    },
    {
      "id": "63fdc7caaff09e0000d33b31",
      "text": " つまりGPT3にとって、日本語で書かれたものは一度に見れる量が少ない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576675
    },
    {
      "id": "63fdc7caaff09e0000d33b32",
      "text": " ChatGPTに「これを参考にして返事して」と文脈情報を渡すことが広く行われているが、この場合に英語で渡す方が2〜3倍の文脈を渡せる、この差はでかい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576141,
      "updated": 1677576676
    },
    {
      "id": "63fdc9bcaff09e00007c0d2f",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677576636,
      "updated": 1677576636
    },
    {
      "id": "63fdcd1aaff09e00007c0d35",
      "text": "トークン従量課金",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577501,
      "updated": 1677577542
    },
    {
      "id": "63fdcd1baff09e00007c0d36",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577501,
      "updated": 1677577501
    },
    {
      "id": "63fdcb32aff09e00007c0d31",
      "text": "[Semantic Search]の精度が日本語ではいまいちだという話がある",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577011,
      "updated": 1677577428
    },
    {
      "id": "63fdcbd6aff09e00007c0d33",
      "text": "　漢字が分割されてるから文字コード表で近くにある漢字は「トークンの1/2や2/3が共通のもの」とみなされてる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577174,
      "updated": 1677577445
    },
    {
      "id": "63fdcce5aff09e00007c0d34",
      "text": "　そりゃあうまく動かすためのハードルが高いな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577445,
      "updated": 1677577465
    },
    {
      "id": "63fdcb3caff09e00007c0d32",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677577021,
      "updated": 1677577021
    },
    {
      "id": "63feefcbaff09e00006e35af",
      "text": "Q: トークナイザがナイーブに各バイトをトークンにしている？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677651915,
      "updated": 1677652020
    },
    {
      "id": "63fef033aff09e00006e35b1",
      "text": "　A: そういうシンプルな話ではない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652020,
      "updated": 1677652204
    },
    {
      "id": "63fef077aff09e0000a012ed",
      "text": "　「information」で1トークンになってるところが見所",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652088,
      "updated": 1677652088
    },
    {
      "id": "63fef03aaff09e00006e35b2",
      "text": "\t　[https://gyazo.com/b5be2d6f88a06f83777451a77264327b]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652026,
      "updated": 1677652109
    },
    {
      "id": "63fef08aaff09e0000a012f4",
      "text": "\t　元が何バイトであっても1トークンにすることには支障ない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652107,
      "updated": 1677652107
    },
    {
      "id": "63fef0a5aff09e00006e35b3",
      "text": "\t　よく見るとわかるんだけど漢字4文字でなぜ9トークンかというと「報」以外が2トークン、「報」が3トークンになってる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652133,
      "updated": 1677652197
    },
    {
      "id": "63fef086aff09e0000a012ee",
      "text": "　ではなぜ「情」を構成する3バイトが2トークンに刻まれているのか",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652264
    },
    {
      "id": "63fef165aff09e00006e35b5",
      "text": "　　入力を素朴にバイトに刻めばトークンは70種類弱ですむ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652326,
      "updated": 1677652362
    },
    {
      "id": "63fef18aaff09e00006e35b6",
      "text": "　　しかし細かく刻むと上記の「視野が狭くなる」現象が起きるので、頻出するバイト列はくっつけて複数バイトで1トークンにする",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652362,
      "updated": 1677652419
    },
    {
      "id": "63fef1c2aff09e00006e35b7",
      "text": "　　この「頻出のものを」というところが想定しているコーパスによって変わる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652419,
      "updated": 1677652443
    },
    {
      "id": "63fef086aff09e0000a012ef",
      "text": "　　GPT3は日本語に特化していないので「情」の出現頻度は「information」の出現頻度よりはるかに低い",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652464
    },
    {
      "id": "63fef1efaff09e00006e35b8",
      "text": "　　なので1つのトークンにする価値はないと判断されている状態",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652464,
      "updated": 1677724865
    },
    {
      "id": "63fef086aff09e0000a012f0",
      "text": "　現状のGPT3のトークンは全部で50000種類程度",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652496
    },
    {
      "id": "63fef086aff09e0000a012f1",
      "text": "　　増やすことは技術的には問題ないが、増やした分だけ学習コストが掛かる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652488
    },
    {
      "id": "63fef086aff09e0000a012f2",
      "text": "　　経済的理由により日本語とかいうマイノリティ言語に割くリソースが少ないという話",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652489
    },
    {
      "id": "63fef086aff09e0000a012f3",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1677652103,
      "updated": 1677652103
    },
    {
      "id": "640870f5aff09e0000c267f8",
      "text": "追記",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274806,
      "updated": 1678274810
    },
    {
      "id": "640870f9aff09e0000c267fa",
      "text": ">[https://twitter.com/kitar/status/1633426489390809088 @kitar]: もしかしてChatGPTのトークナイザーはGPT3より改善されてるのですかね…？今tiktokenで計算してみていたのですが、",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274810,
      "updated": 1678274812
    },
    {
      "id": "640870fcaff09e0000c267fb",
      "text": ">text: 情報密度",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274812,
      "updated": 1678274812
    },
    {
      "id": "640870fcaff09e0000c267fc",
      "text": ">text-davinci-003: 9 tokens",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274812,
      "updated": 1678274812
    },
    {
      "id": "640870fcaff09e0000c267fd",
      "text": ">gpt-3.5-turbo: 4 tokens",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274812,
      "updated": 1678274812
    },
    {
      "id": "640870fcaff09e0000c267fe",
      "text": ">と出てきました。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274812,
      "updated": 1678274812
    },
    {
      "id": "640870fcaff09e0000c267ff",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274812,
      "updated": 1678274812
    },
    {
      "id": "6408725caff09e0000c26800",
      "text": "code:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275165,
      "updated": 1678276319
    },
    {
      "id": "6408725faff09e0000c26801",
      "text": " In [10]: tiktoken.encoding_for_model(\"gpt-3.5-turbo\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275167,
      "updated": 1678275167
    },
    {
      "id": "6408725faff09e0000c26802",
      "text": " Out[10]: <Encoding 'cl100k_base'>",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275167,
      "updated": 1678275167
    },
    {
      "id": "6408725faff09e0000c26803",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275167,
      "updated": 1678275167
    },
    {
      "id": "6408725faff09e0000c26804",
      "text": " In [11]: tiktoken.encoding_for_model(\"text-davinci-003\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275167,
      "updated": 1678275167
    },
    {
      "id": "6408725faff09e0000c26805",
      "text": " Out[11]: <Encoding 'p50k_base'>",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275167,
      "updated": 1678275167
    },
    {
      "id": "640870f9aff09e0000c267f9",
      "text": "なるほど、確かに変わってる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678274810,
      "updated": 1678275242
    },
    {
      "id": "64087275aff09e0000c26806",
      "text": "いやこれChatGPT APIで新しくなったのではないな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678275189,
      "updated": 1678276478
    },
    {
      "id": "64087783aff09e0000c2681a",
      "text": "\t2022年12月の [https://openai.com/blog/new-and-improved-embedding-model New and improved embedding model] でも新しいトークナイザーが使われてる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276483,
      "updated": 1678882886
    },
    {
      "id": "640875dfaff09e0000c26812",
      "text": "\t[https://gyazo.com/ff6822187c0b6d035c4d7595edc1adf2]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276064,
      "updated": 1678276171
    },
    {
      "id": "6408764aaff09e0000c26813",
      "text": "\t\thttps://platform.openai.com/docs/guides/embeddings/what-are-embeddings",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276171,
      "updated": 1678276253
    },
    {
      "id": "6408769caff09e0000c26814",
      "text": "\t[cl100k_base]なら",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276253,
      "updated": 1678276309
    },
    {
      "id": "640876d4aff09e0000c26816",
      "text": "\t\tcode:python",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276309,
      "updated": 1678276312
    },
    {
      "id": "640876d7aff09e0000c26817",
      "text": "\t\t In [12]: tiktoken.get_encoding(\"cl100k_base\").encode(\"情報密度\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276312,
      "updated": 1678276312
    },
    {
      "id": "640876d7aff09e0000c26818",
      "text": "   Out[12]: [40474, 78943, 28741, 27479]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276312,
      "updated": 1678276312
    },
    {
      "id": "6411b86aaff09e0000e34b2c",
      "text": "  4 tokensになった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678882923,
      "updated": 1678882932
    },
    {
      "id": "640877bdaff09e0000c2681d",
      "text": "\thttps://platform.openai.com/tokenizer のデモではV1のGPT-3が使われてるということ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276541,
      "updated": 1678276550
    },
    {
      "id": "640876acaff09e0000c26815",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678276268,
      "updated": 1678276268
    }
  ]
}