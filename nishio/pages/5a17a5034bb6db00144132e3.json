{
  "id": "5a17a5034bb6db00144132e3",
  "title": "ランキングから売り上げ推定",
  "created": 1511499015,
  "updated": 1511501698,
  "lines": [
    {
      "id": "5a17a5034bb6db00144132e3",
      "text": "ランキングから売り上げ推定",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499015,
      "updated": 1511499020
    },
    {
      "id": "5a17a50caff09e0000700908",
      "text": "ある売り上げランキングが「1位が1件、2位が2件、4位が5件同率」だった。ここから売り上げに関してどういう情報が得られるか？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499020,
      "updated": 1511499129
    },
    {
      "id": "5a17a53aaff09e000070090b",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499066,
      "updated": 1511499066
    },
    {
      "id": "5a17a53aaff09e000070090a",
      "text": " ランキングの対象となる商品が何種類あるかは未知である。Nとする。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499066,
      "updated": 1511499166
    },
    {
      "id": "5a17a58daff09e000070090c",
      "text": " 一定期間内の売り上げ [$ X_i (0 \\leq i < N)] は未知。素直に考えるとXはポアソン分布に従う。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499150,
      "updated": 1511499214
    },
    {
      "id": "5a17a5a9aff09e000070090e",
      "text": " ポアソン分布のパラメータ [$ \\lambda_i] は未知。範囲は0以上上限なし。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499178,
      "updated": 1511499237
    },
    {
      "id": "5a17a5a9aff09e000070090f",
      "text": " lambdaの分布は未知なので無情報分布として [$ 0 \\leq \\lambda_i < M] の一様分布からサンプリング。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499178,
      "updated": 1511499387
    },
    {
      "id": "5a17a67aaff09e0000700912",
      "text": " そのパラメータのポアソン分布からサンプリング。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499387,
      "updated": 1511499390
    },
    {
      "id": "5a17a67eaff09e0000700913",
      "text": " 「1位が1件、2位が2件、4位が5件同率」という条件を満たしている物だけ取り出す(棄却サンプリング)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499390,
      "updated": 1511499390
    },
    {
      "id": "5a17a68caff09e0000700914",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499405,
      "updated": 1511499405
    },
    {
      "id": "5a17a5a9aff09e0000700911",
      "text": "N=20の時の、M=(1, 2, 3, 4, 5, 10, 20)における、条件を満たすランキングの出現確率。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499178,
      "updated": 1511500209
    },
    {
      "id": "5a17a83baff09e000070091d",
      "text": "code:Mがgivenの場合の条件付き出現確率:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499835,
      "updated": 1511500239
    },
    {
      "id": "5a17a812aff09e0000700916",
      "text": " 1 0.0149075730471",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499950
    },
    {
      "id": "5a17a812aff09e0000700917",
      "text": " 2 0.0170706725845",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499950
    },
    {
      "id": "5a17a812aff09e0000700918",
      "text": " 3 0.0149454491107",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499950
    },
    {
      "id": "5a17a812aff09e0000700919",
      "text": " 4 0.0165070980522",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499954
    },
    {
      "id": "5a17a812aff09e000070091a",
      "text": " 5 0.010323113451",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499957
    },
    {
      "id": "5a17a812aff09e000070091b",
      "text": " 10 0.00249382777625",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499960
    },
    {
      "id": "5a17a812aff09e000070091c",
      "text": " 20 0.000251332059918",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499795,
      "updated": 1511499964
    },
    {
      "id": "5a17a694aff09e0000700915",
      "text": "というわけで最も出現確率が高いのはM=2の時。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499412,
      "updated": 1511501003
    },
    {
      "id": "5a17a948aff09e000070091f",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500105,
      "updated": 1511500105
    },
    {
      "id": "5a17a84faff09e000070091e",
      "text": "その場合の1位、2位、4位の売り上げ数は(4, 3, 2)が40%、(3, 2, 1)が23%、(5, 3, 2): 134",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511499855,
      "updated": 1511500175
    },
    {
      "id": "5a17a964aff09e0000700922",
      "text": "code:1000件サンプリング中の出現回数:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500132,
      "updated": 1511500190
    },
    {
      "id": "5a17a960aff09e0000700921",
      "text": " (4, 3, 2): 403, (3, 2, 1): 225, (5, 3, 2): 134",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500129,
      "updated": 1511500139
    },
    {
      "id": "5a17a9e8aff09e0000700926",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500264,
      "updated": 1511500264
    },
    {
      "id": "5a17a94aaff09e0000700920",
      "text": "N=40の場合も同様の実験でM=3の時が最も出現確率が高い(0.024)ことがわかる。その場合、(5, 4, 3)が44%。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500107,
      "updated": 1511501011
    },
    {
      "id": "5a17aa15aff09e000070092a",
      "text": "code:1000件サンプリング中の出現回数:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500309,
      "updated": 1511500309
    },
    {
      "id": "5a17aa15aff09e000070092b",
      "text": " (5, 4, 3): 441, (6, 4, 3): 194, (6, 5, 4): 136",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500309,
      "updated": 1511500313
    },
    {
      "id": "5a17abdeaff09e0000700930",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500766,
      "updated": 1511500766
    },
    {
      "id": "5a17abddaff09e000070092f",
      "text": "N=80の場合もM=3が最も出現確率が高い(0.002)ことがわかる、その場合(6, 5, 4)が56%。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500765,
      "updated": 1511501018
    },
    {
      "id": "5a17ac45aff09e0000700939",
      "text": "code:1000件サンプリング中の出現回数:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500870,
      "updated": 1511500870
    },
    {
      "id": "5a17ac24aff09e0000700938",
      "text": " (6, 5, 4): 563, (7, 5, 4): 174, (8, 5, 4): 70,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511500836,
      "updated": 1511500837
    },
    {
      "id": "5a17ad9caff09e000070093a",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501213,
      "updated": 1511501213
    },
    {
      "id": "5a17ad9caff09e000070093b",
      "text": "なお、N=10, M=2の時の出現確率が0.0097、N=15, M=2の時の出現確率が0.029なので、Nはおそらく20弱だろう。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501213,
      "updated": 1511501342
    },
    {
      "id": "5a17aeeaaff09e00009ef1b9",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501547,
      "updated": 1511501547
    },
    {
      "id": "5a17aeeaaff09e00009ef1b8",
      "text": "結論: たぶん一位でも3～5冊しか売れてない(悲しみ)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501547,
      "updated": 1511501565
    },
    {
      "id": "5a17af3daff09e00009ef1bc",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501629,
      "updated": 1511501629
    },
    {
      "id": "5a17af3caff09e00009ef1bb",
      "text": "code:python:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501629,
      "updated": 1511501692
    },
    {
      "id": "5a17af43aff09e00009ef1bd",
      "text": " buf = []",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501636,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1be",
      "text": " num_samples = 0",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1bf",
      "text": " while True:",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c0",
      "text": "     lambdas = np.random.random(NUM_BOOKS) * MAX_LAMBDA",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c1",
      "text": "     sample = np.random.poisson(lambdas)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c2",
      "text": "     sample.sort()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c3",
      "text": "     sample = sample[::-1]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c4",
      "text": "     num_samples += 1",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c5",
      "text": "     if (sample[0] > sample[1] and sample[1] == sample[2] and",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c6",
      "text": "         sample[2] > sample[3] and sample[3] == sample[7] and",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c7",
      "text": "         sample[7] > sample[8]):",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1c8",
      "text": "         buf.append((sample[0], sample[1], sample[3]))",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501682
    },
    {
      "id": "5a17af44aff09e00009ef1cb",
      "text": "         if len(buf) == 1000: break",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501656
    },
    {
      "id": "5a17af44aff09e00009ef1cc",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501637,
      "updated": 1511501698
    },
    {
      "id": "5a17aeecaff09e00009ef1ba",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1511501549,
      "updated": 1511501549
    }
  ]
}