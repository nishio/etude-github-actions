{
  "id": "6090ec09a287e6002291a20e",
  "title": "Hatena2012-04-06",
  "created": 1333638000,
  "updated": 1333638000,
  "lines": [
    {
      "id": "6090ec2daff09e00003db009",
      "text": "Hatena2012-04-06",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00a",
      "text": "code:hatena",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00b",
      "text": " <body>",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00c",
      "text": " *1333684796*Alloyでコンビネータ論理・続編",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00d",
      "text": " 今回は項書換え的な書き方にしてみた。まずKコンビネータから。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00e",
      "text": " >||",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db00f",
      "text": " open util/ordering[Term]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db010",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db011",
      "text": " some abstract sig Term {}",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db012",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db013",
      "text": " one sig K extends Term {}",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db014",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db015",
      "text": " sig Apply extends Term {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db016",
      "text": "   f, g: Term",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db017",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db018",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db019",
      "text": " fact {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01a",
      "text": "   all x, y: Term | (x -> y) in (f + g) => y not in (x.prevs + x)",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01b",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01c",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01d",
      "text": " pred equal (x, y: Term) {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01e",
      "text": "   x in Apply and x.f in Apply and x.f.f = K and y = x.f.g",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db01f",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db020",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db021",
      "text": " fun apply(x, y: Term): Term{  ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db022",
      "text": "   {a: Apply | a.f = x and a.g = y }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db023",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db024",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db025",
      "text": " run {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db026",
      "text": "   some x, y: Term | equal[x, y]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db027",
      "text": " } for 5 Term",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db028",
      "text": " ||<",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db029",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02a",
      "text": " 「all x, y: Term | (x -> y) in (f + g) => y not in (x.prevs + x)」は、ある項AがBを使っていて項BはAを使っていて、という循環が起きると見づらいし説明しにくいので禁止するために入れてみた。(追記: y in x.nextsの方がいいね) このequalの定義では、自分自身とのequalがfalseなのでネーミングが適切ではない気がする。まあこれでrunの述語「some x, y: Term | equal[x, y]」つまり「項xとyがあって、その二つはequal」ってのを探させると期待通りに解が見つかる。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02b",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02c",
      "text": " [f:id:nishiohirokazu:20120406123818p:image]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02d",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02e",
      "text": " yはKで、Apply3がKにKを適用したものだからKK、xはKKにKKを適用したものだから(KK)(KK)となっている。で、Kxy=xのルールによって(KK)(KK) = K K (KK) = Kになるのでめでたしめでたし、という。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db02f",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db030",
      "text": " さて、次はこれにSコンビネータを導入したいところだけど、このequalの実装のままSコンビネータを実装するのはめんどくさいなぁ。Kをまず綺麗にしよう。きれいにした時にバグを仕込んでないかどうか確認するためのfactを作る。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db031",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db032",
      "text": " >||",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db033",
      "text": " pred equal_k (x, y: Term) {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db034",
      "text": " \tx in Apply and x.f in Apply and x.f.f = K and y = x.f.g",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db035",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db036",
      "text": " pred equal_k2 (x, y: Term) {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db037",
      "text": " \tone a, b: Term | x = apply[apply[K, a], b] and y = a",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db038",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db039",
      "text": " check {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03a",
      "text": " \tsome x, y: Term | equal_k[x, y] iff equal_k2[x, y]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03b",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03c",
      "text": " ||<",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03d",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03e",
      "text": " あれ、反例が見つかる。ってことはequal_kとequal_k2は等価ではないのか。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db03f",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db040",
      "text": " [f:id:nishiohirokazu:20120406125530p:image]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db041",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db042",
      "text": " このケースでequal_k2[$x, $y]がfalseらしい。あ、{a, b: Term | $x =  apply[apply[K, a], b]}が空のようだ。期待と違う。{a, b: Term | a = apply[K, b]}は{Apply$3->K$0}だそうな。あれ？関係を返している？あ、これは内包表記が2つのタプルになっているからそう表示されているだけか。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db043",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db044",
      "text": " Apply$2 = apply[Apply$3, Apply$3]がfalseだな。どういうことだろう。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db045",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db046",
      "text": " あ、わかった。apply[Apply$3, Apply$3]が{Apply$2, Apply$0}だ。そうか、全く同じ引数に対して適用されたApplyのインスタンスが複数存在しうるのか。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db047",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db048",
      "text": " じゃあこういう制約をつけよう。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db049",
      "text": " >||",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04a",
      "text": " fact {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04b",
      "text": "   all x, y: Term | lone apply[x, y]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04c",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04d",
      "text": " ||<",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04e",
      "text": " 任意の項x, yについて、apply[x, y]は最大1個である。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db04f",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db050",
      "text": " これで反例が見つからなくなった。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db051",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db052",
      "text": " ** 項の数が…",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db053",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db054",
      "text": " Sの実装をしたのだが、スカラーの集合に対する量化子が展開されるってことを考えるとa, b, cのところがO(N^3)なんじゃないか疑惑。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db055",
      "text": " >||",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db056",
      "text": " pred equal_s (x, y: Term) {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db057",
      "text": " \tone a, b, c: Term {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db058",
      "text": " \t\tx = apply[apply[apply[S, a], b], c]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db059",
      "text": " \t\tand",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05a",
      "text": " \t\ty = apply[apply[a, c], apply[b, c]]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05b",
      "text": " \t}",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05c",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05d",
      "text": " ||<",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05e",
      "text": " 8 Termで解が見つからないが、もっと増やせば見つかるのか、そもそも間違っているのか。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db05f",
      "text": " ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db060",
      "text": " あ、少なくともひとつ間違いがある。現状のequalの定義だと1回の項書換えで到達できる範囲しかequalじゃないな。書き換えてみる。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db061",
      "text": " >||",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db062",
      "text": " pred equal (x, y: Term) {",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db063",
      "text": " \tequal_k[x, y] or equal_s[x, y] or ",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db064",
      "text": " \tone z: Term | equal[x, z] and equal[z, y]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db065",
      "text": " }",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db066",
      "text": " ||<",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db067",
      "text": " 述語は再帰呼び出ししてはいけない、というエラーになった。うーん、どうしようかなぁ。",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db068",
      "text": " </body>",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db069",
      "text": "",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec2daff09e00003db06a",
      "text": "[はてなダイアリー 2012-04-06 https://nishiohirokazu.hatenadiary.org/archive/2012/04/06]",
      "created": 1333638000,
      "updated": 1333638000,
      "userId": "582e63d27c56960011aff09e"
    }
  ]
}