{
  "id": "6090ebf8a287e60022919e6b",
  "title": "Hatena2008-07-04",
  "created": 1215097200,
  "updated": 1215097200,
  "lines": [
    {
      "id": "6090ec1eaff09e00003caf6e",
      "text": "Hatena2008-07-04",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf6f",
      "text": "code:hatena",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf70",
      "text": " <body>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf71",
      "text": " *1215132864*Re: 西尾くんはセンスピやってて楽しかったのかなぁ？",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf72",
      "text": " <a href=\"http://d.hatena.ne.jp/kajuntk/20080621/1214038649\">西尾くんはセンスピやってて楽しかったのかなぁ？ - Automatons Hacking Guide</a>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf73",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf74",
      "text": " Yes.",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf75",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf76",
      "text": " === 終了 ===",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf77",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf78",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf79",
      "text": " いや、ネタはさておき、色々誤解があるようなので訂正しておこう。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7a",
      "text": " 僕も最初は「話したい人が無条件で話せるようにすると、面白くない発表も結構な割合で入ってくるんじゃないだろうか」と危惧していた。学内向けの修論中間発表会とかそうだよね。でも、実際に開催してみると想像以上に面白かった。いま考えると「(義務でも仕事でもなく)自発的に発表をする人」はある程度「面白い人レベル」が高いんだな。「しないといけないから仕方なく発表している人」のいる会と比べるのがそもそも間違いだった。すごく面白かった。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7b",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7c",
      "text": " >>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7d",
      "text": " 西尾君がカンファレンス実施のために払ったコストよりも、得られる楽しみというインセンティブが著しく小さかったことを意味する。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7e",
      "text": " <<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf7f",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf80",
      "text": " うん。カンファレンスは面白かったけど、それ以上に「月一回カンファレンス開催」を続けるのは大変だった、というだけのことなんだよ。たとえば id:hayamiz の発表はとても『面白そう』だった。残念ながらあのときはIRCに荒らしがやってきて回線が切断されるなどのトラブルが発生して対処に必死だったのであまり聞けていない。そういうのがつらいなぁ、と。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf81",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf82",
      "text": " >>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf83",
      "text": " センスピの思想として「誰でも参加できることで、潜在的に面白い人を表面化する」って言うのがあったと思うんだけど、僕は世の中の面白い人は表面化されてる人しかいないと思うんだ。つまり、潜在的に面白い人っていないと思うんだ。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf84",
      "text": " <<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf85",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf86",
      "text": " 生まれたときから顕在化している面白い人なんていない。潜在的に面白い人、面白くなりうる人は世の中にいっぱいいる。なんらかのきっかけで顕在化して、その体験がその人自身にとって楽しい物であったから繰り返すようになって、その結果多くの人から「顕在化した面白い人」とみなされるようになるんだと思う。少なくとも僕は元来非コミュで、「誘われてLL Day&Nightで発表したら想像以上にウケた」という経験をしていなければその後のもろもろの発表はすべて存在しなかっただろう。コミュニティ的な活動もしていなかっただろう。今の状況は前よりもハッピー。そういう「生態系から自分が得た物」はふくらませて生態系に返すのが生態系を維持するために必要だと思っている。ロッジとかで「使った前よりきれいにして返しましょう」って書いてある、あれですよ。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf87",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf88",
      "text": " -----",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf89",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8a",
      "text": " むう、<a href=\"http://d.hatena.ne.jp/earth2001y/20080622/p1\">イベントものの持続可能性 - おびなたのはてな日記</a>と<a href=\"http://d.hatena.ne.jp/kajuntk/20080623/1214204807\">急いで1000人話さすことが重要なの？ - Automatons Hacking Guide</a>についても言及するつもりだったのにもう時間がないや。送信！",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8b",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8c",
      "text": " *1215184981*[TopCoder]Single Round Match 408 Div2 1000pt",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8d",
      "text": " 練習がてらに解いてみる。問題は大まかに説明すると「赤玉と青玉が合計で奇数個入った袋があり、あなたがランダムに１個とり、敵が青玉を１個とる。最終的にあなたが最後に取る玉が青ならあなたの勝ち。」というもの。厳密な問題文はアカウントがあれば下のリンクで見に行ける。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8e",
      "text": " http://www.topcoder.com/stat?c=problem_statement&pm=9754&rd=12180",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf8f",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf90",
      "text": " さて、とりあえず問題文に書いてあることを簡潔に実装するとこうなった。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf91",
      "text": " >|cpp|",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf92",
      "text": "   double getProbability(int redCount, int blueCount) {",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf93",
      "text": "     if(redCount == 0) return 1.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf94",
      "text": "     if(blueCount < 2) return 0.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf95",
      "text": "     double p = 1.0 * redCount / (redCount + blueCount);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf96",
      "text": "     return p * getProbability(redCount - 1, blueCount - 1) \\",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf97",
      "text": "            + (1 - p) * getProbability(redCount, blueCount - 2);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf98",
      "text": "   }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf99",
      "text": " ||<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9a",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9b",
      "text": " これで手元でのテストがだいたい通る。1個failするけど、それはテストに使っているTZTesterってプラグインのバグで、浮動小数点数で返した答えが正しいかをイコールで判断しているのが原因。サーバに送ってテストすると通る。submit!",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9c",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9d",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9e",
      "text": " で、Practice OptionからRun System Testを選んでもっとたくさんのテストケースを食わせてみる。案の定パフォーマンスを何も考えていないコードなので{131, 3000}が来たときに2秒の時間制限に引っかかってfailした。手元のコードのテストケースを書き換えて実行してみる。うは、60秒経っても終わらないwww",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caf9f",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa0",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa1",
      "text": " まぁ、それじゃあとりあえずこのコードでは何度も同じ値で関数が呼ばれるので、計算した値をキャッシュしておくことにしよう。Pythonでパフォーマンスを考えずに書くならここはタプルをキーにした辞書を作るところだけど、pair<int, int>とかやるのもばからしいし、今回引数の範囲は上限が4000だと問題文に明記してあるのでこれでいいよね。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa2",
      "text": " >|cpp|",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa3",
      "text": "     int key = redCount * 4001 + blueCount;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa4",
      "text": " ||<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa5",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa6",
      "text": " さて、そんなわけでmapの説明を見つつ書いてみる。cacheに既に値があればそれを返し、なければ計算してcacheに入れてから返す。こんな感じかな。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa7",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa8",
      "text": " >|cpp|",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafa9",
      "text": " typedef map<int, double> MID;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafaa",
      "text": " class MarblesInABag {",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafab",
      "text": " public:",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafac",
      "text": "   MID cache;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafad",
      "text": "   double getProbability(int redCount, int blueCount) {",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafae",
      "text": "     int key = redCount * 4001 + blueCount;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafaf",
      "text": "     MID::iterator i = cache.find(key);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb0",
      "text": "     if(i != cache.end()){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb1",
      "text": "       return i->second;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb2",
      "text": "     }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb3",
      "text": "     if(redCount == 0) return 1.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb4",
      "text": "     if(blueCount < 2) return 0.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb5",
      "text": "     double p = 1.0 * redCount / (redCount + blueCount);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb6",
      "text": "     double result = p * getProbability(redCount - 1, blueCount - 1)",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb7",
      "text": "                     + (1 - p) * getProbability(redCount, blueCount - 2);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb8",
      "text": "     pair<int, double> value(key, result);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafb9",
      "text": "     cache.insert(cache.begin(), value);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafba",
      "text": "     return result;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafbb",
      "text": "   }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafbc",
      "text": " }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafbd",
      "text": " ||<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafbe",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafbf",
      "text": " さて、これで60秒以上掛かっていたのが2～3秒で済むようになった。しかし制限時間は2秒だ。これではまだ遅い。まぁ、これでも遅いってのは実は想定の範囲内なんだけど。関数を何度も呼ぶのは効率が悪そうなので、ループで値の小さいところから埋めていくように変える。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc0",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc1",
      "text": " >|cpp|",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc2",
      "text": "   double getProbability(int redCount, int blueCount) {",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc3",
      "text": "     typedef pair<int, double> PID;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc4",
      "text": "     const int MAX_PLUS_1 = 4001;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc5",
      "text": "     int key = redCount * MAX_PLUS_1 + blueCount;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc6",
      "text": "     // when r = 0",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc7",
      "text": "     for(int b(1); b <= blueCount; b += 2){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc8",
      "text": "       cache.insert(cache.begin(), PID(b, 1.0));",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafc9",
      "text": "     }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafca",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafcb",
      "text": "     for(int r(1); r <= redCount; ++r){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafcc",
      "text": "       int b(1 - (r % 2));",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafcd",
      "text": "       cache.insert(cache.begin(), PID(r * MAX_PLUS_1 + b, 0.0));",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafce",
      "text": "       for(b += 2; b <= blueCount; b += 2){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafcf",
      "text": " \tdouble p = 1.0 * r / (r + b);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd0",
      "text": " \tdouble result = p * cache.find((r - 1) * MAX_PLUS_1 + b - 1)->second \\",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd1",
      "text": " \t  + (1 - p) * cache.find(r * MAX_PLUS_1 + b - 2)->second;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd2",
      "text": " \tcache.insert(cache.begin(), PID(r * MAX_PLUS_1 + b, result));",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd3",
      "text": "       }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd4",
      "text": "     }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd5",
      "text": "     return cache.find(key)->second;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd6",
      "text": "   }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd7",
      "text": " ||<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd8",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafd9",
      "text": " なに、これでも2秒超える？関数呼び出しがボトルネックだと思っていたが違うのか？！えーと、ここから何が削れるんだ？やっぱりmapに全部突っ込んだのが間違いかな。。。必要なところだけをvectorに入れる形に変えてみる。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafda",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafdb",
      "text": " >|cpp|",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafdc",
      "text": "   double getProbability(int redCount, int blueCount) {",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafdd",
      "text": "     const int MAX_PLUS_1 = 4001;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafde",
      "text": "     vector<double> cache(MAX_PLUS_1);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafdf",
      "text": "     vector<double> new_cache(MAX_PLUS_1);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe0",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe1",
      "text": "     // when r = 0",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe2",
      "text": "     for(int b(1); b <= blueCount; b += 2){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe3",
      "text": "       cache[b] = 1.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe4",
      "text": "     }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe5",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe6",
      "text": "     for(int r(1); r <= redCount; ++r){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe7",
      "text": "       int b(1 - (r % 2));",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe8",
      "text": "       new_cache[b] = 0.0;",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafe9",
      "text": "       for(b += 2; b <= blueCount; b += 2){",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafea",
      "text": " \tdouble p = 1.0 * r / (r + b);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafeb",
      "text": " \tnew_cache[b] = p * cache[b - 1] + (1 - p) * new_cache[b - 2];",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafec",
      "text": "       }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafed",
      "text": "       cache.swap(new_cache);",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafee",
      "text": "     }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafef",
      "text": "     return cache[blueCount];",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff0",
      "text": "   }",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff1",
      "text": " ||<",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff2",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff3",
      "text": " ふう。だいぶ縮んだ。さっきの「2～3秒」ってのは実はコンパイル時間も含まれていたのでそれを除くと、1.2秒から0.077秒に縮んだ。15倍。submit。うん、全部のシステムテストに通った。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff4",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff5",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff6",
      "text": " 今回の教訓は「mapはそんなに速くない」ということか。この程度の規模の問題だったら余裕だと思ったんだけど、想像より遅かった。まぁ、最大4000x4000個の値がつっこまれるわけだからなぁ。vectorに変えて15倍速くなったことに関してはあんまり意外ではない。完全にサイズ固定で確保してswapしつつ書き込んでいるだけだから配列を使っているも同然だし、書き込みも読み出しもO(1)だし。もっと速くても驚かない。",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff7",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff8",
      "text": " ",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caff9",
      "text": " さて、解けたのでめでたしめでたしと言うことで帰ろうと思ったらもう終電がなくなっていたorz",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caffa",
      "text": " </body>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caffb",
      "text": " <comments>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caffc",
      "text": " <comment>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caffd",
      "text": " <username>hyoshiok</username>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003caffe",
      "text": " <body>運営側に手間暇がかかっちゃうと続かないので、ゆるゆるの運営が長続きするコツかなあなどと思っています。カーネル読書会なんかは、ust隊がいるときのみの中継だし、ビデオも三脚固定でとりっぱなし。<br>なんと言っても、一番前の席に座って質問とかガンガンしているのは、わたしだし、そもそもわたしがそのお話を聞きたいから開催しているようなものだし、自分のためにわざわざお話してくれてありがとうみたいなノリだったりします。<br>でもって、運営コストなんつーのは、ほとんど何もかかっていなくて、ピザとビールの発注くらいで、その省エネルギー型開催がエコ。<br>お気楽ゆるゆるでもう88回開催。</body>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cafff",
      "text": " <timestamp>1215656653</timestamp>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cb000",
      "text": " </comment>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cb001",
      "text": " </comments>",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cb002",
      "text": "",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    },
    {
      "id": "6090ec1eaff09e00003cb003",
      "text": "[はてなダイアリー 2008-07-04 https://nishiohirokazu.hatenadiary.org/archive/2008/07/04]",
      "created": 1215097200,
      "updated": 1215097200,
      "userId": "582e63d27c56960011aff09e"
    }
  ]
}