{
  "id": "5e576dd9d2f8a800177087d2",
  "title": "Regroupの共同編集",
  "created": 1582788060,
  "updated": 1582797503,
  "lines": [
    {
      "id": "5e576dd9d2f8a800177087d2",
      "text": "Regroupの共同編集",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788060,
      "updated": 1582796117
    },
    {
      "id": "5e578d1faff09e0000b78d72",
      "text": "Regroupで共同編集ツールがどうやって実現されてるのかの解説",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796066,
      "updated": 1582796106
    },
    {
      "id": "5e578d44aff09e0000b78d73",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796100,
      "updated": 1582796100
    },
    {
      "id": "5e576de7aff09e0000cc4d50",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788072,
      "updated": 1582788094
    },
    {
      "id": "5e576dfeaff09e0000cc4d52",
      "text": " ReactDOM.render(<Router />, document.getElementById('root'));",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788094,
      "updated": 1582788094
    },
    {
      "id": "5e576dfcaff09e0000cc4d51",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788093,
      "updated": 1582788093
    },
    {
      "id": "5e576dffaff09e0000cc4d53",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788095,
      "updated": 1582788098
    },
    {
      "id": "5e576e01aff09e0000cc4d55",
      "text": " const Router = () => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788098,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d56",
      "text": "   return (",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d57",
      "text": "     <HashRouter>",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d58",
      "text": "       <Route path=\"/:id\" component={WhenHashSpecified} />",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d59",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d5a",
      "text": "       <Route exact path=\"/\">",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d5b",
      "text": " \t\t...",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788115
    },
    {
      "id": "5e576e10aff09e0000cc4d6a",
      "text": "       </Route>",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788112,
      "updated": 1582788112
    },
    {
      "id": "5e576e08aff09e0000cc4d67",
      "text": "     </HashRouter>",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d68",
      "text": "   );",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e08aff09e0000cc4d69",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788105,
      "updated": 1582788105
    },
    {
      "id": "5e576e00aff09e0000cc4d54",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788096,
      "updated": 1582788096
    },
    {
      "id": "5e576e30aff09e0000cc4d6b",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788144,
      "updated": 1582788146
    },
    {
      "id": "5e576e31aff09e0000cc4d6d",
      "text": " function WhenHashSpecified(obj: any) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e32aff09e0000cc4d6e",
      "text": "   return (",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e32aff09e0000cc4d6f",
      "text": "     <App urlParam={obj.match.params.id} />",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e32aff09e0000cc4d70",
      "text": "   );",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e32aff09e0000cc4d71",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e30aff09e0000cc4d6c",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788146,
      "updated": 1582788146
    },
    {
      "id": "5e576e35aff09e0000cc4d73",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788149,
      "updated": 1582788199
    },
    {
      "id": "5e576e67aff09e0000cc4d75",
      "text": " const App = (props: { urlParam: string }) => { ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788199,
      "updated": 1582788205
    },
    {
      "id": "5e576e67aff09e0000cc4d7b",
      "text": "   useUrlParam(props.urlParam)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788199,
      "updated": 1582788199
    },
    {
      "id": "5e576e73aff09e0000cc4d7d",
      "text": "   ...",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788211,
      "updated": 1582788212
    },
    {
      "id": "5e576e67aff09e0000cc4d7c",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582788199,
      "updated": 1582788210
    },
    {
      "id": "5e577864aff09e0000cc4d7e",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582790757,
      "updated": 1582790760
    },
    {
      "id": "5e577867aff09e0000cc4d7f",
      "text": " export const useUrlParam = (urlParam: string) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582790760,
      "updated": 1582791681
    },
    {
      "id": "5e577c00aff09e0000cc4d80",
      "text": "   useEffect(() => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791681
    },
    {
      "id": "5e578cf5aff09e0000cc4dbc",
      "text": "     // resolve map name",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796022,
      "updated": 1582796026
    },
    {
      "id": "5e578cf5aff09e0000cc4dbd",
      "text": "   \t// subscribe changes on server",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796022,
      "updated": 1582796023
    },
    {
      "id": "5e577c12aff09e0000cc4dae",
      "text": "   \t...",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791698,
      "updated": 1582791699
    },
    {
      "id": "5e577c00aff09e0000cc4d81",
      "text": "   }, [urlParam]);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791692
    },
    {
      "id": "5e577c00aff09e0000cc4d9d",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791681
    },
    {
      "id": "5e577c00aff09e0000cc4d9e",
      "text": "   const items = getGlobal().items;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791681
    },
    {
      "id": "5e577c00aff09e0000cc4d9f",
      "text": "   useEffect(() => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791681
    },
    {
      "id": "5e577c26aff09e0000cc4daf",
      "text": "   \t// save to server if items are changed",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791718,
      "updated": 1582791729
    },
    {
      "id": "5e577c00aff09e0000cc4da0",
      "text": "   }, [items]);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791717
    },
    {
      "id": "5e577c00aff09e0000cc4daa",
      "text": " };",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791681
    },
    {
      "id": "5e577c00aff09e0000cc4dab",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582791681,
      "updated": 1582791764
    },
    {
      "id": "5e5780b9aff09e0000cc4dba",
      "text": "// save to server if items are changed",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792890,
      "updated": 1582792890
    },
    {
      "id": "5e5780e3aff09e0000b78d6f",
      "text": " マウスのドラッグで付箋の位置が動いた時に、各マウスムーブごとにリクエストが飛ぶともっさりするので100msごとにした",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792932,
      "updated": 1582796031
    },
    {
      "id": "5e57811daff09e0000b78d70",
      "text": "　今は「そもそもマウスムーブごとにReact的状態の更新をするのも良くない」と考え直した",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792990,
      "updated": 1582793065
    },
    {
      "id": "5e5780bbaff09e0000cc4dbb",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792893,
      "updated": 1582792893
    },
    {
      "id": "5e5780b2aff09e0000cc4db0",
      "text": " if (toSave) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792882,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db1",
      "text": "   // do nothing",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db2",
      "text": " } else {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db3",
      "text": "   toSave = true;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db4",
      "text": "   setTimeout(() => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db5",
      "text": "     toSave = false;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db6",
      "text": "     saveToServer()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db7",
      "text": "   }, 100)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db8",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792897
    },
    {
      "id": "5e5780b3aff09e0000cc4db9",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582792883,
      "updated": 1582792883
    },
    {
      "id": "5e578c6eaff09e0000b78d71",
      "text": "// resolve map name",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582795886,
      "updated": 1582796058
    },
    {
      "id": "5e578d13aff09e0000cc4dbf",
      "text": "　URLパラメータを元に、参照すべきマップの名前を解決する。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796058,
      "updated": 1582796604
    },
    {
      "id": "5e578d12aff09e0000cc4dbe",
      "text": "　最初に作ったときはマップを見るリンクで編集できて、その後で「編集できないけど閲覧できる」GoogleDocみたいなのを実現したくてこうなった。閲覧リンクから編集リンクを予想できない仕組み。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796051,
      "updated": 1582796602
    },
    {
      "id": "5e578f3daff09e0000b78d75",
      "text": "　エラー処理は雑、キーが見つからない場合は白紙のマップにファールバックする",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796605,
      "updated": 1582796671
    },
    {
      "id": "5e578f7faff09e0000b78d76",
      "text": "　ここが「インターネットに接続してなかったらローカルのデータを表示」にしたい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796671,
      "updated": 1582796702
    },
    {
      "id": "5e578d90aff09e0000b78d74",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796176,
      "updated": 1582796302
    },
    {
      "id": "5e578e0eaff09e0000cc4dc1",
      "text": " if (urlParam.match(/key=([^&]*)/)) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796302,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc2",
      "text": "   const key = RegExp.$1;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc3",
      "text": "   db.collection(\"key_to_map\").doc(key).get().then((doc: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796311
    },
    {
      "id": "5e578e0eaff09e0000cc4dc5",
      "text": "     if (doc.exists) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc6",
      "text": "       console.log(\"map exists\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc7",
      "text": "       const toConnect = true;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc8",
      "text": "       const { isReadOnly, mapname } = doc.data()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dc9",
      "text": "       setGlobal({",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dca",
      "text": "         toConnect: toConnect,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dcb",
      "text": "         isReadOnly: isReadOnly,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dcc",
      "text": "         mapname: mapname",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dcd",
      "text": "       })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dce",
      "text": "       setUpReadSubscription(toConnect, isReadOnly, mapname);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dcf",
      "text": "     } else {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd0",
      "text": "       // doc.data() will be undefined in this case",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd1",
      "text": "       console.log(\"No such document!\");",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd2",
      "text": "     }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd3",
      "text": "   }).catch((error: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd4",
      "text": "     console.log(\"Error getting document:\", error);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd5",
      "text": "   });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e0eaff09e0000cc4dd6",
      "text": " } else {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796308
    },
    {
      "id": "5e578e70aff09e0000cc4ddb",
      "text": "   // handle special case for development",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796400,
      "updated": 1582796413
    },
    {
      "id": "5e578e0eaff09e0000cc4dd7",
      "text": " } ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796303,
      "updated": 1582796416
    },
    {
      "id": "5e578e0caff09e0000cc4dc0",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796301,
      "updated": 1582796301
    },
    {
      "id": "5e578fb5aff09e0000cc4ddc",
      "text": "// subscribe changes on server",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796726,
      "updated": 1582796726
    },
    {
      "id": "5e578ff3aff09e0000cc4de3",
      "text": "基本はこう",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796788,
      "updated": 1582796795
    },
    {
      "id": "5e578fb6aff09e0000cc4dde",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796726,
      "updated": 1582796783
    },
    {
      "id": "5e578feeaff09e0000cc4ddf",
      "text": " let unsubscribe = db.collection(\"map\").doc(mapname).onSnapshot((doc: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796783,
      "updated": 1582796786
    },
    {
      "id": "5e578feeaff09e0000cc4de0",
      "text": "   loadFromServer(doc.data());",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796783,
      "updated": 1582796786
    },
    {
      "id": "5e578feeaff09e0000cc4de1",
      "text": " });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796783,
      "updated": 1582796786
    },
    {
      "id": "5e578fb5aff09e0000cc4ddd",
      "text": "書き込み可能な時には「サーバのデータを読む前に手元で変更して上書きしないように」という意図で、まず読み込んでからsubscribeしてるが、そもそも読み込みが完了するまで編集不能にすべき",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796726,
      "updated": 1582796958
    },
    {
      "id": "5e57906baff09e0000b78d78",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796908,
      "updated": 1582796908
    },
    {
      "id": "5e57906baff09e0000b78d79",
      "text": "マップの新規作成",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796908,
      "updated": 1582796926
    },
    {
      "id": "5e5790fdaff09e0000cc4df9",
      "text": "\t初期状態をサーバに書き込んで新規タブで開いてる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797054,
      "updated": 1582797114
    },
    {
      "id": "5e579194aff09e0000b78d7a",
      "text": "\tネットワーク接続がない時にも新規作成したい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797205,
      "updated": 1582797361
    },
    {
      "id": "5e579232aff09e0000b78d7b",
      "text": "\tしかしaddのcatchはすぐには呼ばれない、黙って内部でリトライされてしまうため",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797364,
      "updated": 1582797418
    },
    {
      "id": "5e5792a4aff09e0000cc4dfa",
      "text": "\t\t[Firestoreでオフライン判定]単体ではできない件も関係してそう",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797476,
      "updated": 1582797503
    },
    {
      "id": "5e57901faff09e0000b78d77",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796832,
      "updated": 1582796961
    },
    {
      "id": "5e5790a1aff09e0000cc4de6",
      "text": " const createNewMap = () => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796961,
      "updated": 1582796962
    },
    {
      "id": "5e5790a1aff09e0000cc4de7",
      "text": "   saveToNewMap(INITIAL_GLOBAL_STATE).then((docRef: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796962,
      "updated": 1582796962
    },
    {
      "id": "5e5790a1aff09e0000cc4de8",
      "text": "     window.open(`/#/key=${docRef.id}`)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796962,
      "updated": 1582796962
    },
    {
      "id": "5e5790a1aff09e0000cc4de9",
      "text": "   })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796962,
      "updated": 1582796962
    },
    {
      "id": "5e5790a1aff09e0000cc4dea",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796962,
      "updated": 1582796962
    },
    {
      "id": "5e5790a1aff09e0000cc4deb",
      "text": "code:ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796962,
      "updated": 1582797025
    },
    {
      "id": "5e5790e1aff09e0000cc4dec",
      "text": " export const saveToNewMap = (state: TYPE_GLOBAL_STATE) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797025,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4ded",
      "text": "   const doc = convertStateToFirestore(state);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4dee",
      "text": "   return db.collection(\"map\").add(doc)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4def",
      "text": "     .then((docRef: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df0",
      "text": "       return db.collection(\"key_to_map\").add(",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df1",
      "text": "         { mapname: docRef.id }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df2",
      "text": "       )",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df3",
      "text": "     })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df4",
      "text": "     .catch((error: any) => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df5",
      "text": "       alert(`Error: ${error}`)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df6",
      "text": "     });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df7",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797026
    },
    {
      "id": "5e5790e1aff09e0000cc4df8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582797026,
      "updated": 1582797027
    },
    {
      "id": "5e5790a0aff09e0000cc4de5",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1582796960,
      "updated": 1582796960
    }
  ]
}