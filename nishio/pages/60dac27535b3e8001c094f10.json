{
  "id": "60dac27535b3e8001c094f10",
  "title": "ReactNを露出してCypressから使う",
  "created": 1624949366,
  "updated": 1624971703,
  "lines": [
    {
      "id": "60dac27535b3e8001c094f10",
      "text": "ReactNを露出してCypressから使う",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949366,
      "updated": 1624949376
    },
    {
      "id": "60dac280aff09e00007984a4",
      "text": "[ReactNを露出する]して[Cypress]からsetGlobalを使ってテスト用の状態を作り、それをテストする。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949376,
      "updated": 1624949472
    },
    {
      "id": "60dac2e0aff09e0000abefa7",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949473,
      "updated": 1624949473
    },
    {
      "id": "60dac2e0aff09e0000abefa6",
      "text": "できた。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949472,
      "updated": 1624949472
    },
    {
      "id": "60dac29eaff09e00007984a7",
      "text": "[https://gyazo.com/4555d5f590786e4b4d2a4982ddf31aec]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949406,
      "updated": 1624949409
    },
    {
      "id": "60dac2a0aff09e00007984a8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949409,
      "updated": 1624949409
    },
    {
      "id": "60dac281aff09e00007984a5",
      "text": "code:App.tsx",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949377,
      "updated": 1624949504
    },
    {
      "id": "60dac300aff09e00007984aa",
      "text": " function App() {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949504,
      "updated": 1624949504
    },
    {
      "id": "60dac300aff09e00007984ab",
      "text": "   const [fusens] = useGlobal(\"fusens\");",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949504,
      "updated": 1624949504
    },
    {
      "id": "60dac300aff09e00007984b1",
      "text": "   return (...);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949504,
      "updated": 1624949519
    },
    {
      "id": "60dac300aff09e00007984bb",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949504,
      "updated": 1624949504
    },
    {
      "id": "60dac2fcaff09e00007984a9",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949501,
      "updated": 1624949501
    },
    {
      "id": "60dac32aaff09e00007984bd",
      "text": "code:index.tsx",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949547,
      "updated": 1624949550
    },
    {
      "id": "60dac32daff09e00007984bf",
      "text": " setGlobal(INITIAL_GLOBAL_STATE);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949550,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984d9",
      "text": " const movidea = {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984da",
      "text": "   getGlobal,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984db",
      "text": "   setGlobal,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984dc",
      "text": " };",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984dd",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984de",
      "text": " const debug = {};",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984df",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e0",
      "text": " declare global {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e1",
      "text": "   interface Window {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e2",
      "text": "     debug: any;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e3",
      "text": "     movidea: typeof movidea;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e4",
      "text": "   }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e5",
      "text": " }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e6",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e7",
      "text": " window.movidea = movidea;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dac36eaff09e00007984e8",
      "text": " window.debug = debug;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624949614
    },
    {
      "id": "60dacd15aff09e0000abefb0",
      "text": "解説は[ReactNを露出する]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624952086,
      "updated": 1624952094
    },
    {
      "id": "60dac36eaff09e00007984e9",
      "text": " 僕はアプリの公開時にもユーザ(主に僕)がハックしやすいようにmovidea(アプリ名)にsetGlobalなどをつけてるけど、debugの方につけてリリースビルドでは削るって設計もアリだと思う。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949614,
      "updated": 1624952098
    },
    {
      "id": "60dac527aff09e0000abefa8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624950060,
      "updated": 1624950060
    },
    {
      "id": "60db19b4aff09e00005e3b6f",
      "text": "テストコード",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624971701,
      "updated": 1624971703
    },
    {
      "id": "60dac3bcaff09e00007984ea",
      "text": "code:cypress/.../adjust_font_size.js",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949692,
      "updated": 1624949739
    },
    {
      "id": "60dac3ccaff09e00007984eb",
      "text": " /// <reference types=\"cypress\" />",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949709,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850a",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850b",
      "text": " describe('adjust font size', () => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850c",
      "text": "   beforeEach(() => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850d",
      "text": "     cy.visit('/')",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850e",
      "text": "     let a = 1;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079850f",
      "text": "     let b = 1;",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798510",
      "text": "     const fusens = [];",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798511",
      "text": "     for (let i = 0; i < 11; i++) {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798512",
      "text": "       [a, b] = [b, a + b];",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798513",
      "text": "       fusens.push({",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798514",
      "text": "         text: \">\" + \"あ\".repeat(a),",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798515",
      "text": "         x: 50 * i,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798516",
      "text": "         y: 50 * i,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798517",
      "text": "       });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798518",
      "text": "     }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798519",
      "text": "     cy.window().its('movidea').then(movidea => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851a",
      "text": "       setTimeout(() => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851b",
      "text": "         movidea.setGlobal({ fusens });        ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851c",
      "text": "       })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851d",
      "text": "     });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851e",
      "text": "   })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079851f",
      "text": " ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798520",
      "text": "   it('fusen sizes', () => {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798521",
      "text": "     cy.get('.fusen').should('have.length', 12).first()",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798522",
      "text": "       .should(\"have.css\", \"font-size\", \"66px\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798523",
      "text": "       .should(\"not.have.css\", \"align-items\", \"flex-start\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798524",
      "text": "     cy.get('.fusen').eq(1).should(\"have.css\", \"font-size\", \"53px\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798525",
      "text": "     cy.get('.fusen').eq(2).should(\"have.css\", \"font-size\", \"38px\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798526",
      "text": "     cy.get('.fusen').eq(10)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798527",
      "text": "       .should(\"have.css\", \"font-size\", \"10px\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798528",
      "text": "       .should(\"have.css\", \"align-items\", \"flex-start\")",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e0000798529",
      "text": "   })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079852a",
      "text": " })",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624949965
    },
    {
      "id": "60dac4cdaff09e000079852b",
      "text": "setTimeoutに関しては see [✅CypressからsetGlobalするとフックが反応しない]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949965,
      "updated": 1624950037
    },
    {
      "id": "60dac3ebaff09e0000798509",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949739,
      "updated": 1624949740
    },
    {
      "id": "60dac336aff09e00007984d3",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1624949559,
      "updated": 1624949563
    }
  ]
}